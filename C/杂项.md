# 杂项

## 内联函数

### 概念

**内联函数**是那些定义较小且在发生其函数调用的位置处被替换的函数。函数替换完全是编译器的选择。

### 示例

```c
#include <stdio.h>

//请在内联之前使用“静态”。使用static关键字会强制编译器在链接器中考虑此内联函数。

static inline int add(int x, int y, int z)
{
    return x + y + z;
}
int main()
{
    int x = 1;
    int y = 2;
    int z = 3;

    printf("add %d\n",add(x,y,z));
    return 0;
}
```

### [场景](<http://c.biancheng.net/cpp/html/933.html>)

1. 函数调用也会带来降低效率的问题，因为调用函数实际上将程序执行顺序转移到函数所存放在内存中某个地址，将函数的程序内容执行完后，再返回到转去执行该函数前的地方。这种转移操作要求在转去前要保护现场并记忆执行的地址，转回后先要恢复现场，并按原来保存地址继续执行。因此，函数调用要有一定的时间和空间方面的开销，于是将影响其效率。特别是对于一些函数体代码不是很大，但又频繁地被调用的函数来讲，解决其效率问题更为重要。
2. 在程序编译时，编译器将程序中出现的内联函数的调用表达式用内联函数的函数体来进行替换。显然，这种做法不会产生转去转回的问题，但是由于在编译时将函数休中的代码被替代到程序中，因此会增加目标程序代码量，进而增加空间开销，而在时间代销上不像函数调用时那么大，可见它是以目标代码的增加为代价来换取时间的节省。

### 注意

1. 在内联函数内不允许用循环语句和开关语句。
2. 内联函数的定义必须出现在内联函数第一次被调用之前。
3. 本栏目讲到的类结构中所有在类说明内部定义的函数是内联函数。

