## 积硅步, 致千里

### 启动和停止

1. `--dbpath`

   使用此选项可以指定一个目录为数据目录. 其默认值为 /data/db ( 在windows 中为MongoDB 可执行文件所在磁盘中的 /data/db 目录 )。机器上的每个 `mongod` 进程都需要属于自己的数据目录, 即若同一机器上运行三个 mongod 实例, 则需三个独立的数据目录。mongod 启动时，会在其数据目录中创建一个mongod.lock 文件， 以阻止其他的 mongod 进程使用此数据目录。

2.  `--port`

   此选项用以指定服务器监听的端口号。

3.  `--fork` 

   启动此选项以调用fork创建子进程，在后台运行MongoDB。启用 --fork 选项时，必须同时启用 --logpath 选项。

4.  `--logpath` 

   使用此选项，所有输出信息会被发送至指定文件，而非在命令行上输出。假设拥有该目录的__写权限__ ，若指定文件不存在，启用该选项后则自动生成一个文件。建议使用 `--logappend` 选项。

   ```html
   使用 --logappend 选项可以在日志文件末尾追加日志
   mongod --dbpath D:mongodb --port 27017 --logpath D:/mongologs/mongotest.log --logappend
   ```

   __3.6版本的会将日志文件重命名再创建新的配置文件__

5.  `--config`

   额外加载配置文件，未在命令行中指定的选项将使用配置文件中的参数。选项通常用于确保每次重新启动时的选项都是一样的。

   ```html
   mongod --config ～/.mongodb.conf 
   
   port = 27017
   logpath = /var/log/mongodb.log
   logappend = true
   ```

6.  注意事项

   * 首次安装启动MongoDB时，应查看一下日志。日志中常包含重要的警告信息，及时解决这些问题可预防随之而来的错误。

7.  停止mongodb运行    shell辅助函数 `db.shutdownServer()`

### 安全性

不要将MongoDB服务器直接暴露在外网上。应尽可能地限制外部对MongoDB的访问。最好的方式是设置防火墙。

1. `--bind_ip`

   指定MongoDB监听的接口。通常将其设置为一个内部Ip地址，从而保证应用服务器和集群中其他成员的访问，同时拒绝外网的访问。

   参考网址 `https://docs.mongodb.com/manual/administration/configuration/#configuration-security`

### 平常使用的命令

1. MongoDB默认记录耗时超过100毫秒的查询信息。

   ```html
   level有三种级别
   0 – 不开启
   1 – 记录慢命令 (默认为>100ms)
   2 – 记录所有命令
   
   参数为1的时候，默认的慢命令是大于100ms，当然也可以进行设置
   　db.setProfilingLevel( level , slowms )  实例 db.setProfilingLevel( 1 , 120 );
     db.getProfilingStatus();
   ```

2. MongoDB自带的一个日志切割

   ```html
   db.adminCommand({"logRotate":1})
   ```

