---
title: '随机圆形经纬度的算法'
date: 2017-12-27 11:48:27
tags: 算法
---
1. 算法
	```php
	var_dump(randomLatLon(36.65017, 116.97156, 6, 5000));
	/**
	 * 递归计算指定范围圆形的不定个数的经纬度
	 * @param  [float] $lat   [lat<纬度>] 36.65017
	 * @param  [float] $lon   [lng<经度>] 116.97156
	 * @param  [float] $limit [单位km]
	 * @param  [int] $count   [想要生成的随机个数]
	 * @return [array]        [返回随机的圆形范围的坐标]
	 */
	function randomLatLon($lat, $lon, $limit, $count)
	{
	    if (!isset($tmp)) {
	        $tmp = array();
	    }
	    $rand1 = mt_rand(1, 100) / 100;
	    $rand2 = mt_rand(1, 100) / 100;
	    //将经纬度转化成弧度
	    $startlat = $lat * pi() / 180;
	    $startlon = $lon * pi() / 180;
	    //地球的半径 单位km
	    $radiusEarth = 6372.796924;
	    //将最大距离转化为弧度
	    $maxdist = $limit / $radiusEarth;
	    $dist = acos($rand1 * (cos($maxdist) - 1) + 1);
	    $brg = 2 * pi() * $rand2;
	    $lat1 = asin(sin($startlat) * cos($dist) + cos($startlat) * sin($dist) * cos($brg));
	    $lon1 = $startlon + atan2(sin($brg) * sin($dist) * cos($startlat), cos($dist) - sin($startlat) * sin($lat1));
	    $lat1 = $lat1 * 180 / pi();
	    $lon1 = $lon1 * 180 / pi();
	    if ($count > 0) {
	        --$count;
	        $tmp = randomLatLon($lat, $lon, $limit, $count);
	        $tmp[] = $lat1 . ',' . $lon1;
	    }
	    return $tmp;
	}
	```